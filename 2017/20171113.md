# 13 November 2017


_Is Dominoh a context-free language?_

`::Foo bar baz:: $foo $#bar`

```
fragment -> block, text, block, { tag }
block -> "::"
tag -> symbol , identifier
symbol -> text | text, symbol
identifier -> text 
```

Dominoh is not a context-free language. What makes the language not context-sensitive
is that symbols at the end of fragments are ambiguous. The only way you can
distinguish a symbol at the end of a fragment is by first parsing all of the
`:::` blocks. So I guess there would be two parsing passes?

I believe adding a `MetaBlock` (`:::`) to the end of the `SymbolList`
makes Dominoh context-free:

```
:::
$ : foo
# : bar
@ : baz

foo , this is a foo subtext 
bar , this is a bar subtext
baz , this is a baz subtext
:::

::this is a fragment text::$foo $#bar $#@baz::::
```

```ebnf
Document = Text, { Pair }, Text

Pair 
  = Meta, Text, Fragment
  | Fragment, Text, Meta

Meta = MetaBlock, MetaBody, MetaBlock

MetaBlock = ":::"

MetaBody 
  = Whitespace, TagExpr, Whitespace, SubTextExpr, Whitespace
  | Whitespace, TagExpr, Whitespace, SubTextExpr, Whitespace, MetaBody
  | Whitespace, SubTextExpr, Whitespace, TagExpr, Whitespace
  | Whitespace, SubTextExpr, Whitespace, TagExpr, Whitespace, MetaBody

TagExpression = Tag, LineBreak

Tag = AnyChar ":" AnyChar

SubTextExpr = SubText, LineBreak

SubText = Text ":" Text

Fragment 
  = FragmentBlock, Whitespace, AnyChar, Whitespace, FragmentBlock, SymbolList, MetaBlock

FragmentBlock = "::"

SymbolList
 = Symbol
 | Symbol, SymbolList

Symbol = AnyChar, Whitespace

LineBreak 
  = "\n" 
  | "\n", LineBreak

Space 
  = "\s"
  | "\s", Space

Tab 
  = "\t"
  | "\t", Tab

Whitespace 
  = Space
  | Space, Whitespace
  | Tab
  | Tab, Whitespace
  | LineBreak
  | LineBreak, Whitespace
  | Empty 

Text 
  = Any 
  | Empty

Any = ? one or more occurrences of any character ?

Empty = ""
```

**Further reading**

- [Backus-Naur Form (BNF)](https://classes.engineering.wustl.edu/cse425s/resources/bnf/)
- [Why isn't there a formal grammar for Markdown?](http://roopc.net/posts/2014/markdown-cfg/)
